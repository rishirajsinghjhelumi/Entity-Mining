 <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Entity Mining for Movies and Music</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Loading Bootstrap -->
    <link href="static/bootstrap/css/bootstrap.css" rel="stylesheet">

    <!-- Loading Flat UI -->
    <link href="static/css/flat-ui.css" rel="stylesheet">
    <link href="static/css/index.css" rel="stylesheet">
    <link href="static/nprogress/nprogress.css" rel="stylesheet">

    <link rel="shortcut icon" href="static/img/favicon.ico">

    <!-- Load JS here for greater good =============================-->
    <script src="static/js/jquery-1.8.3.min.js"></script>
    <script src="static/js/jquery-ui-1.10.3.custom.min.js"></script>
    <script src="static/js/jquery.ui.touch-punch.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/bootstrap-select.js"></script>
    <script src="static/js/bootstrap-switch.js"></script>
    <script src="static/js/flatui-checkbox.js"></script>
    <script src="static/js/flatui-radio.js"></script>
    <script src="static/js/jquery.tagsinput.js"></script>
    <script src="static/js/jquery.placeholder.js"></script>
    <script src="static/js/freewall.js"></script>
    <script src="static/js/spin.min.js"></script>
    <script src="static/nprogress/nprogress.js"></script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements. All other JS at the end of file. -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
      <script src="js/respond.min.js"></script>
    <![endif]-->
    
  </head>
  <body>
  <div id="wrap">

    <div class="container container-full">
    {% include 'header.html' %}

        <div class="row">
            <div class="col-xs-3">
          <div class="todo">
            <div class="todo-search">
              Categories
            </div>
            <ul class="categories">

              <li class="" >
              <a href = 'javascript:tmdbMovies("/movies/top_rated/10/0","top_rated")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Top Rated
                  </h4>
                  A list of Top Rated Movies.
                </div>
                </a>
              </li>

              <li class="" >
              <a href = 'javascript:tmdbMovies("/movies/now_playing/10/0","now_playing")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Now Playing
                  </h4>
                  A list of Now Playing Movies.
                </div>
                </a>
              </li>

              <li class="" >
              <a href = 'javascript:tmdbMovies("/movies/most_popular/10/0","most_popular")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Most Popular
                  </h4>
                  A list of Most Popular Movies.
                </div>
                </a>
              </li>

              <li class="" >
              <a href = 'javascript:tmdbMovies("/movies/upcoming/10/0","upcoming")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Upcoming
                  </h4>
                  A list of Upcoming Movies.
                </div>
                </a>
              </li>

              <li class="" >
              <a href = 'javascript:rtMovies("/movies/top_box_office/10","top_box_office")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Top Box Office
                  </h4>
                  A list of Top Box Office Grossing Movies.
                </div>
                </a>
              </li>

              <li class="" >
              <a href = 'javascript:rtMovies("/movies/opening_this_week/10","opening")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Opening This Week
                  </h4>
                  A list of Movies opening this week.
                </div>
                </a>
              </li>


              <li class="" >
              <a href = 'javascript:rtMovies("/movies/in_theatre/10/1","in_theaters")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Movies In Theatre
                  </h4>
                  A list of Movies in Theatre Now.
                </div>
                </a>
              </li>


              <li class="" >
              <a href = 'javascript:rtMovies("/dvd/top_rental/10","top_rentals")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Top Rental DVD's
                  </h4>
                  A list of top Rental DVS's.
                </div>
                </a>
              </li>


              <li class="" >
              <a href = 'javascript:rtMovies("/dvd/current_released/10/1","current_releases")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Currently Released DVD's
                  </h4>
                  A list of Currently Released DVD's.
                </div>
                </a>
              </li>

              <li class="" >
              <a href = 'javascript:rtMovies("/dvd/new_released/10/1","new_releases")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Newly Released DVD's
                  </h4>
                  A list of Newly Released DVD's.
                </div>
                </a>
              </li>

              <li class="" >
              <a href = 'javascript:rtMovies("/dvd/upcoming/10/1","upcoming")'>
                <div class="todo-icon fui-video"></div>
                <div class="todo-content">
                  <h4 class="todo-name">
                    Upcoming DVD's
                  </h4>
                  A list of Upcoming DVD's.
                </div>
                </a>
              </li>

            </ul>
          </div>
        </div>

        <div class="col-xs-9">
        <span id="spin-me"  style="position: absolute;display: block;top: 20%;left: 50%;"></span>
          <div id="freewall" class="free-wall"  >
            <h1>Please Select a Category</h1>
          </div>
        </div>
            

        </div>

        <div id="push"></div>
    </div>
    <!-- /.container -->
</div>
    {% include 'footer.html' %}

    <script type="text/javascript">

      var opts = {
        lines: 17, // The number of lines to draw
        length: 23, // The length of each line
        width: 14, // The line thickness
        radius: 33, // The radius of the inner circle
        corners: 0.6, // Corner roundness (0..1)
        rotate: 90, // The rotation offset
        direction: 1, // 1: clockwise, -1: counterclockwise
        color: '#000', // #rgb or #rrggbb or array of colors
        speed: 1.6, // Rounds per second
        trail: 50, // Afterglow percentage
        shadow: true, // Whether to render a shadow
        hwaccel: true, // Whether to use hardware acceleration
        className: 'spinner', // The CSS class to assign to the spinner
        zIndex: 2e9, // The z-index (defaults to 2000000000)
        top: 'auto', // Top position relative to parent in px
        left: 'auto' // Left position relative to parent in px
      };
      var target = document.getElementById('spin-me');
      var spinner = new Spinner(opts);

      var movies = null;

      var tmdbMovies = function(url,type){

        NProgress.start();
        spinner.spin(target);

        console.log(type);

        $.ajax({
          url: url,
          type: 'GET',
          async:false,
        }).done(function(data) {
          movies = data[type];
        },"json");

        var temp = '<div class="brick">'
        + '<a href="{movie_url}">'
        + '<img src="{url}" width="100%">'
        + '<div class="info">'
        + '<h6>{release}</h6>'
        + '{title}'
        + '</div>'
        + '</a>'
        + '</div>';

        var  html = '', limitItem = movies.length;
        for (var i = 0; i < limitItem; ++i) {
          html += temp.replace("{title}", movies[i].title).replace("{release}", movies[i].release_date).replace("{url}", movies[i].image || "/static/img/holder.png").replace("{movie_url}","/movies/tmdb/info/" + movies[i].id_tmdb);
        }
        $("#freewall").html(html);

        updateUI();

        NProgress.done();

      };

      var rtMovies = function(url,type){

        NProgress.start();
        spinner.spin(target);

        console.log(type);

        $.ajax({
          url: url,
          type: 'GET',
          async:false,
        }).done(function(data) {
          movies = data[type];
        },"json");

        var temp = '<div class="brick">'
        + '<a href="{movie_url}">'
        + '<img src="{url}" width="100%">'
        + '<div class="info">'
        + '<h6>{release}</h6>'
        + '{title}'
        + '</div>'
        + '</a>'
        + '</div>';

        var  html = '', limitItem = movies.length;
        for (var i = 0; i < limitItem; ++i) {
          var release_date = movies[i].release_dates.theater || movies[i].release_dates.dvd || "Not Known";
          var photo = movies[i].posters.original;
          html += temp.replace("{title}", movies[i].title).replace("{release}", release_date).replace("{url}", photo || "/static/img/holder.png").replace("{movie_url}","/movies/rt/info/" + movies[i].id);;
        }
        $("#freewall").html(html);

        updateUI();

        NProgress.done();

      };

      var search = function(query){
        rtMovies("/movies/rt/search/{query}/10/1".replace('query',encodeURI(query)),"movies");
      };

      $('#search-form').submit(function () {
        NProgress.start();
        search($( "#srch-term" ).val());
        $( "#srch-term" ).val('');
        NProgress.done();
        return false;
      });

      var updateUI = function(){
        
        var wall = new freewall("#freewall");
        wall.reset({
          selector: '.brick',
          animate: true,
          cellW: 200,
          cellH: 'auto',
          onResize: function() {
            wall.fitWidth();
          }
        });
        
      var images = wall.container.find('.brick');
      var length = images.length;
      images.find('img').load(function() {
        -- length;
        wall.fitWidth();
        if (!length) {
            spinner.stop();
        }
      });
      };

    </script>